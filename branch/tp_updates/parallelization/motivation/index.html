<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Motivation &mdash; Real-life compute cluster workflows - Parallelization  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx_lesson.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/term_role_formatting.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx_rtd_theme_ext_color_contrast.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />

  
    <link rel="shortcut icon" href="../../_static/coderefinery.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script src="../../_static/minipres.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
    <link rel="next" title="Concepts" href="../concepts/" />
    <link rel="prev" title="Embarassingly Parallel Problems" href="../" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../" class="icon icon-home">
            Real-life compute cluster workflows - Parallelization
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">The lesson</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../">Embarassingly Parallel Problems</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Motivation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#why-parallelize-at-all">Why parallelize at all</a></li>
<li class="toctree-l3"><a class="reference internal" href="#advantages-and-pitfalls-of-parallelization">Advantages and pitfalls of parallelization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#moving-the-parallelization-to-the-scheduler-level">Moving the parallelization to the scheduler level</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/">Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../code_adaptions/">Example Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../array_jobs/">Parallelize using Slurm Array jobs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../conclusions/">Conclusions and recommendations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../pitfalls/">Pitfalls when parallelising code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../conclusions/">Conclusions and recommendations</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../quick-reference/">Quick Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../instructor-guide/">Instructor’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../exercises/">List of exercises</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../">Real-life compute cluster workflows - Parallelization</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../">Embarassingly Parallel Problems</a></li>
      <li class="breadcrumb-item active">Motivation</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/coderefinery/content/blob/main/content/parallelization/motivation.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="motivation">
<h1>Motivation<a class="headerlink" href="#motivation" title="Permalink to this heading"></a></h1>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Avoid unnecessary learning curve of language internal parallelization mechanisms</p></li>
<li><p>General applicability to any programming language</p></li>
<li><p>Harness resource availability on large clusters</p></li>
</ul>
</div>
<section id="why-parallelize-at-all">
<h2>Why parallelize at all<a class="headerlink" href="#why-parallelize-at-all" title="Permalink to this heading"></a></h2>
<p>While the actual processing speeds of processors hasn’t increased that much over the last decade (~3.6 Ghz i~ 2010 vs 4.1 Ghz in 2020)
the number of cores has increased a ot ( from max 6 (most machines having 2) to up to 64 (with most having ~6)). This is particularily
true if we look at clusters, where the number of machines and thus available cores has risen a lot, while the single core speed hasn’t
improved that much.
In addition, the amount of data we are processing nowadays, often requires us to repeat the same pocesses multiple times for each data
point (e.g. in pre-processing). And while many libraries have inherent parallelization mechanisms for several types of mathematical
processes that does not cover re-application of the same process unless we use in-language parallelization techniques.</p>
</section>
<section id="advantages-and-pitfalls-of-parallelization">
<h2>Advantages and pitfalls of parallelization<a class="headerlink" href="#advantages-and-pitfalls-of-parallelization" title="Permalink to this heading"></a></h2>
<p>The main advantage of parallelizing code is the speedup achieved from parallel processing of the same lines of code for multiple input
values. In theory, this leads to a computation time that’s about 1/n of the unparallelized process, where n is the number of cores used
for processing the data. However, this theoretical maximum is rarely reached, as there often is some overhead in collecting the final
results of the parallelized process. There are also often costs associated with parallelizing code. Depending on the programming
language, one cost is clarity of the code (as parallelization often requires the initialization of worker pools) another is often
additional memory requirements, as data might need to be copied to be available to each of the processes performing the calculation.
In addition to these costs, there can be hidden side effects that can actually make parallel processing slow down a computation.
Imagine, you have a system with 4 cores and you have a program in python using some numpy (a python math library) functions which
can use multiple cpus. If you don’t paralellize, the multi-threading functions from numpy will use all 4 cores (if they can). Now imagine,
that you use multiprocessing (a python library to parallelize code) to run 4 computations in parallel. If you don’t take care, all
4 computations will try to run multi-threaded copmutations which could interfere with each other, leading to a significant overhead in
the multiprocessing library and the runtime actually getting worse ( an example can be found <a class="reference external" href="https://superfastpython.com/numpy-blas-multiprocessing/">here</a>)
The following figures also show this issue.
First, you have a function which runs some code 10 times in parallel, making use of all the cores on your system.
<img alt="Parallel execution" src="../../_images/parallel_execution.svg" />
If you would patrallelize this code on the same machine, i.e. you don’t have more CPU, you just run all parallel computations in parallel,
you end up with a situation as follows:
<img alt="Dual parallel execution" src="../../_images/dual_parallel_execution.svg" />
This obviously puts a burdon on the operating system to schedule all the concurrent calls, which will slow down the overall computation.
Only if you can simultaneously add more cores to the computation, that are exclusivelu reserved for to each step in the for loop
will your code actually run faster, otherwise it will run slower.</p>
</section>
<section id="moving-the-parallelization-to-the-scheduler-level">
<h2>Moving the parallelization to the scheduler level<a class="headerlink" href="#moving-the-parallelization-to-the-scheduler-level" title="Permalink to this heading"></a></h2>
<p>By moving the parallelization of the code to the scheduler level of your cluster you can get around a lot of the problems
you would otherwise encounter in making your code parallel.</p>
<ul class="simple">
<li><p>Each process can make use of all the resources you assign to it,
and doesn’t have to worry about scheduling issues, as there are no other threads that can interfere with it.</p></li>
<li><p>You don’t have to worry about language specific parallelization mechanisms</p></li>
<li><p>Your code stays cleaner, as all the extras needed for in language parallelization can be left out, making it easier to read and debug</p></li>
</ul>
<p>What you will be doing is submitting multiple processes, one for each entry (or a set of entries) of your input data.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../" class="btn btn-neutral float-left" title="Embarassingly Parallel Problems" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../concepts/" class="btn btn-neutral float-right" title="Concepts" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024-, The contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>